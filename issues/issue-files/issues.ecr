# IAM policy for ECR ??

aws ecr create-repository --repository-name hello-world  # create aws ecr repo
aws ecr get-authorization-token
authorizationToken": "QVdTOmV5SndZWGxzYjJGa0lqb2lXalUxTmxSMk9GaFBZM0prY3pkVU1Hd3pXbTgxY2paeWJ6WnlRelUyY1c5alUxRmxjalZ5WnpSR05ITlRWek5pUWxoTGFrbDRZVFo1TkdOMGFsSlpRamN4Y1UxWGVqUklUbVJXYjBwc2JsUTJhMGN2V2xRemJqVm5hRzkxYTBWRmRXZHlOa1FyWVRkeGNrOTNiRzkxUVdZNVJubDZaV2RuYURWa1dXa3lOaXQyZVVOT2JtTlFRbkJJUVdad2NVcE5iMVJOTWtaQ1VuaGxMMU5pYlZwUGIzTnRhREZzYVZZemJsUkVkVU55WkdRNFJIcEdUVE5sYURJemEwUXJlbmxoT0VWcWVFMU1NUzlsVkZkaVVqVm5aa001ZEdGa2QzY3ZTRmhTWW1acVNHSjZOVVV4TnpWNE9UaDNkMDlTT1RkRFZVRkhNR1JsYVU1RlJHSmpha0pGUjBwRGVIRkVibFJZWTFSTVNIRXlTM0JIWVZGNWRsWm1lVUpPVlZwVk9FVmpjWGxTUWxWSVFYb3pVMFpwVVdWUE5tbGtRWGhrWlc0dmEwZDZVbVZGV2s1eWVrMVNSekpwVm5RMmQyeDBOSGd4TVZWNk5WUlllbGhLWjJSdlMyVk1URlJRYVRjd2VsRlJWbTlXT0V0dFpHZE5lbVlyWjBWQ05rWjJVRGxvVGxseldpdDZZMVZHUjJaeE4yWkZWeXRpY3pCV2JpOHJURlp1U0d4bGJXWlpXVUpOU21sbFltRlBaVGxxYUZST2VXaE9MekIwWTBWRlZVcGxiVFptWWpKdGVHaEVVa3BvY2swNFNscFdiMVJRWm1kbUsxZHBUVGxuTURkc00zYzBNekZ5Y3k4dmNrUkVVM1UyVEVKb055OHJiMmRVVHpSVWFIRlhORlZuU1ZkcmJIbHVRVEJKWVZsaEszbHhSR0ZyVFZvelRGbGhjeXQyTkVaU1NWSkxlRkZqTmsxclVtaFZZMmQzY0RBd1YxRkZaRmxUV0VKQ01HMHdaVlZvVG1Zd1oyVlZjSGhhVlRGaFRuRk5ibmsyT1RWclRtUnRhVm8xU1dwT1JuaHVlV0ZTVnpOWlZHdHJablJFVWpaSGNtdzRhREpMZWxGM2IwZzBibkYyU3pOWU1qVTRPRzVVVGpCUE1rWm9TeTh4V25oQk1IaGxNMkl3YjI0Mkx6TnBUVkZ4WlU1YVpFdElVM2REYWpKR1pUVnRabWh0VERCNk5sRllOVmd6ZG1aV05qQnNlbEFyYUhrM1RVeERWSFJMY0dSb1NucHlkVTlZTWtWVGRXSjFkalJ3UTFkdmRteENTbUZ3VjJvMFVrUm1aMVZYVVhsRlpGTkpXVlJUWm1GMVUwdzVVazVzYVc1UmRrbGxlR3d6UTFjMFNFUldNMGhzTVZneGRFVkVZbE5SZVc1alJsaEhOSEpTVFhrNVJtOXJTekZwUVhKcFF5dElha05JYTFadVUzTlhha05GZW1WMWEyczBXVGRZYlc1eWNVcHpWRWg2VDNob1R6bE9ia1YyTWtkcU1scEdSMGh2YlROR05rTmtWVTlLYzBaVGJIUTVhbEpaWVhoeVlsSkVXRk54T1c5TFRWSXpkVmhUT1VOamNFUkhRbnBqZURGd1FVNDRRVE16VGtOb1lYWlVZMGd4Y1doWmIxTk5OWE53U21WYVNpdE1OV3BDU25SQ1EwbEdaMVZaU1RObE5VNUpkVWxSU2pOdlprcHNZVE5HTmtndlpWUjBlR2hZVHpkTmRWRlFkRFkzVDJORWVqSTNRWE5YWjFwSWFsSkxMMVp1T1ZKblZUSm9WbXRIY1RkSmVGVnRNM0JpVGtFeGExSjBTRTVFTkU5RWJIQjRVelJqVVRNclJsZE1NSGxaU0M5RGVXRnRkbkFyY0ZORlZXdHdSVkV6VTFSS01FdGlPSFJITUc5VVNsaEVZV3M5SWl3aVpHRjBZV3RsZVNJNklrRlJSVUpCU0doM2JUQlpZVWxUU21WU2RFcHROVzR4UnpaMWNXVmxhMWgxYjFoWVVHVTFWVVpqWlRsU2NUZ3ZNVFIzUVVGQlNEUjNaa0ZaU2t0dldrbG9kbU5PUVZGalIyOUhPSGRpVVVsQ1FVUkNiMEpuYTNGb2EybEhPWGN3UWtKM1JYZElaMWxLV1VsYVNVRlhWVVJDUVVWMVRVSkZSVVJJUVc1WE5rbG5VRlpEYUdnNFNUQlZVVWxDUlVsQk56STBZVWhaT1RGYVlYaEVjRTQwZEdGSWIxcEhPWGRtY1RCVWRqVmFZMk5zVDBoV1YweGlRVzVuVDNWclUzUkhVMGxqUTA1M2FFVkhSVk5UUWpGaVRWRTNVMWR3ZW1WU1EwTXpLMWhLUjJzOUlpd2lkbVZ5YzJsdmJpSTZJaklpTENKMGVYQmxJam9pUkVGVVFWOUxSVmtpTENKbGVIQnBjbUYwYVc5dUlqb3hOVEV5TmpVeU56WTBmUT09

aws ecr get-login --no-include-email
docker login -u AWS -p 
eyJwYXlsb2FkIjoiYUZMbklTTDhTUjZOQzJVKzZkbWltRVdsazZURXA4bGlxUG1ISU5qakxJRlVMdmV2UlpIUENaRzlJb2RoTitkalFkdTZXdDBSVG9KZnRNTm0wbXNuWG9nSmQvSUlia0N0Mm5ROWQyUHNiVEt0QzZOb1lUYU1IV1FGSUlCL2ZVemdGZ2xwQmQ1ak9HSmhMa0hvMDAwNHJnVEsxb3pHOWxjR2hEelIwbTMyTHJLNjRvdkZ3QytNVFFrT0pBS0dvM3dKSHEzODZlSVFDQUpremJoeVB0Y1JIQUxmZVJZMUl1TmF4UzJONEZrYVZEL2JPS2tHVVI5RU1wTU1GcmNMRW5wWStiRW1DeUE2RTI5NENuU1NkT0FPcHdVS1RvaG82ZFBCNjY0eXN0enlncXZkbWhrN0tVVmxzRVg5L2ZrWVhyMFBzdDVaOFU5V3dVSVRBS0ZJcjlKSkN5NzkrOXkzOU9qT2dQbkJnSHN0aGZGYkdBaEJjdzVxeU1hT3dOSmp1OHpUL0VMUkpzZUVvNUdXK0JHL2dackt5bjdUYlhrcERvblVtYWhDeVoramR2QXI1dXh6SWlUb3gvN1orQVRUNmlkNjlUUWRoV1VrTkxwWVpFOVptOWthZ3RZRTBkcG95eThMYWVJUHpyd1d4eGxkbFVzbCtkQ0NGTTVJTnRWZ2F0cE5zQ0hpV2dFbzVJSzQ3N281aHo5NXdrUnNKWlkxNU5nUk1ONkZZY3NINGsvU3lzd3pvZUMzb2I2amppU1FKVEVYWVc1S0JUMUNXOVorUHc3VG52alpZbFRTNTNsZ2tNYU8vM0g5Tmo3cUlXc21mMGZReHJDN2VHTC92N0p0bXh1K1dQeHlHQnVrWm9UcEhxNUxLUWpyQjd5dDRwRGMyUXVnQTNiVU1jOExISFJDckxoSWxrRlROa0FuQkJnb1hERkdyMzVoTDdmblJHcGZnL0NJZnpoLzhpZ25aUENxbjdPeTNUYVd5bW1wc2dzWXlCZkJVcVpRNWs5TCtzYkpoaE5NWTM0b21TNTd2TnBOSW1idy9Ga01Bb2Z4SXN2RUdxTDVDM0p5QkZqUzNjd0hoVXRsNDM1MmZUM2VmcWFVdy9ibHQ5VUUwU0N2Um1qS21qRUc2U0FtdlNmbDhUaWkraGZNM1M4S2pHTXAxSnBGWncxVk5WR2xndlAwc0dhOVRGMUZiaHhsYzZTeEptbVFTUXlDMUV6RHVqaDJKQUw0WlhPMkNraDdWWDNZZGpSVWhnbFJablM4M25tYk0zNlNESzRXRnZqK2RpMjBrb3VLMUg3d2kwekp6QlhJV0hiRXRiS3Q0M0VvNmxYa3hmMUNxRy9WQTlqNlROYUg5QTVFWTRNV09rWmp2QnFnMkFpVXNOVmJCTm9sZUkxR3grQzFyU1JzVnpNYmVUR3luV1NxaHc0RmJabFdwNnZ0bVJRYytjdHRIdGc9IiwiZGF0YWtleSI6IkFRRUJBSGh3bTBZYUlTSmVSdEptNW4xRzZ1cWVla1h1b1hYUGU1VUZjZTlScTgvMTR3QUFBSDR3ZkFZSktvWklodmNOQVFjR29HOHdiUUlCQURCb0Jna3Foa2lHOXcwQkJ3RXdIZ1lKWUlaSUFXVURCQUV1TUJFRURPREwvc1JFRnJ3SFFyOVpSd0lCRUlBNzdxM1gyZkY4ay9wQk1zMFpBV1dsVXVSZnNVaURIOUtJck4rZ09BOEhPREk3aXlFQTFGQ3c0N09XSlgrenR0dWh4WW0zaXhVUGx3Z1dnZms9IiwidmVyc2lvbiI6IjIiLCJ0eXBlIjoiREFUQV9LRVkiLCJleHBpcmF0aW9uIjoxNTEyNjUxMTg2fQ== https://589424541475.dkr.ecr.us-east-1.amazonaws.com

# try to tag that repo
docker tag hello-world 589424541475.dkr.ecr.us-east-1.amazonaws.com/hello-world

$ aws ecr get-authorization-token  # query auth token
{"authorizationData": [{"authorizationToken": "QVdTOmV5SndZWGxzYjJGa0lqb2lTbmx4VDFac1RWSnJVSFpJZFRSNWRETkhRalZCUkhKdGRTc3JPVkpuWVd3clZFZFhZVlJVZEZOM1ZGTXlObkJ1UVRSRmNtdFVSekJ4YWs1T1VFdHRUbWw0Y1ZWUFpuTnFhbmhWV2xOWWQyRnlaRWcxZFc1a2J6bExPVzR6Y0ZaT1UxQmFTakpSTkRoQk5HSnpVVXhvVlZadGVGbEdMMDVVU21sYU9GZDZVV1E1YXpSdlNHdzFORWQ0V0ZaRE5Vc3diVGxQT0VsVWQxbDBkbE5ZZGtSc0wwMDVZbFV3VWtaNVVUTkVNVUpXWTIxUGREUnFWRmhFZWpGbVZVeHpiV1JoV0ROcGIwdEZXbVY1YkRGMUt6QnFRa3RRUjJaR1drZElTVEpNV1VGQlNYQnJVRGRtTjA5eVQxTnVObE5QV2xKSlZrNWtVRkJLYUZRd1VtRkhkVVpCVDFKWldrc3lLMk01ZFVSQ1dWRkpSekZLZGl0eWNrMVRabGhOV1ZocVRuVTVVSGhTVTNNd1dsRXhSeTlDWW5WMGMweFVNV05hV1hGVlpYSm9UekozV205bVRqQnRZbk5OVWpsQlIxWXpjRWhoVlRoQ1RtVkhZWHBIT1U1R0wyUnRjVFpJTWtsTmNEWlZZV2h6TkdZcmRUVmpaV2xuVkZWcFJuTllUM1pxSzFOelQxSk5Ua2hwVUVvMlZ6WXJNWHBaZEZoWFJXZFZSek5CUm5WcWJETnFRVTlXYVRSVlNIZG1aVEpUUVdSVWRucHdiV2hCTm5aMFZTdHhOazUwTjA0elMxQmlTRnBYU1djeU5GUkJVV3BGVG5VM05YaFdhRmRHZW1jeWVEWmxSMlZZYlVWbE1qVllZVnB0V0daQ1FraDZNVzlGY1hwQlUxZFBkMmt3TjNWT1RpOVVUbmt2Ym5Fd1MwcGhkMmN3U2xoVFIxUmFNamN6VlhjeGJrTTRXWFJNU0hCcmExcFpjM1JCY2tSVGRtMVBjMk4zUmtGRmVHb3JjVGc0VUVacU1FRlNVelY0Ukhwd2Fsb3pSMHhQVldOWmRWZzNaQ3N2YURKVmF5OXZaRzFGV2xsdGRYaG9ObU0zUjFOU2RHRnpNMWhRYzNGd1FXaDFWQ3R1UjJOdVpuaFJkVzlHWVdsNWVFbHZhM1IwWVdnMldqaDJiRWhWWlhOdlZWaGpiMHRFWWt0eFMyVlBWMmQ0VG1ZeU5sQktjRE5VVERkTGRFOVRSRmcwYWt4c1MwVnJkR0YyZERReVZVRTBSWGcxZVhBeFRtNDBNSFI1Y201YVVUQk5Ra1V4TVVkaU5sTk5aV2hwU0VWRVpYaHRkSEZaYldkRVlqSjBLemRUT1N0eVRUUldTMWhIUXk5T1pHNW5ObTlMUWpnNGRFMWhVWEp2ZEVNeWNqbFZPRkZtYW1WQ05HMXhVR1J0UzFCS2FuWnNkVGxYUXpGd05HcFVORU54VG5ReU5rTjZVMkoxTXpaclMzRk5aek40V0doeFpqRkNZaXMyUWtkVEsyZEdPQzl4WVRObFdWaFhORTVUVHpob1kzSmxjMmM0VW1Kd1ZHYzFOM1E0UzNveVRWWXdMMjlPYjAxVmMxZEJkekJWYTBsRFptcFpNWGw0UXpkNWRYWTVNRk5ZYjB4eGRqbDZRVW81TlUxNWNVbEZWRU14ZVdGUVEyMDFjMnBWZW5OblZrUjNTbUV5WjB0RGJFczVSRWwwTm1SbGVXNTJNVkpuTUZacU5uTXJMMDlOYlhBNFlVMU5TbEJQY1ZaTFNqRkRUbWh3VWpoTFFVUTJhbmRHYjJWdFNqWjNkRk4zUzBKRU9WSnFhVGswTTBaMk1ERkRkRFJDUWpCR1pGUnhTMmMzWkhweVFrZHphMjVEVDFweFlUQlljbE5UWm5kU2FWVnViR2c0WVVsUk5GTnlOWEJpV2xNME4wOU5iVVU5SWl3aVpHRjBZV3RsZVNJNklrRlJSVUpCU0doM2JUQlpZVWxUU21WU2RFcHROVzR4UnpaMWNXVmxhMWgxYjFoWVVHVTFWVVpqWlRsU2NUZ3ZNVFIzUVVGQlNEUjNaa0ZaU2t0dldrbG9kbU5PUVZGalIyOUhPSGRpVVVsQ1FVUkNiMEpuYTNGb2EybEhPWGN3UWtKM1JYZElaMWxLV1VsYVNVRlhWVVJDUVVWMVRVSkZSVVJEUmtOcVUyaHhURFkwVVZOVUszYzFVVWxDUlVsQk4yZGFlalZ2YUhGb1ZVWnpVWHAzWkdobU9IWldXWHBrZERkNk56UlJTVzR6TWs1Rk9FNUpPV1JPY0VGbVNVeHhUSG80TW5wRFpubGhaMFp5VDNSbWJWQlNWakY0VFd0alREWnRiMHRFYW5jOUlpd2lkbVZ5YzJsdmJpSTZJaklpTENKMGVYQmxJam9pUkVGVVFWOUxSVmtpTENKbGVIQnBjbUYwYVc5dUlqb3hOVEV5TmpRNE9UQTBmUT09","expiresAt": 1512648904.174,"proxyEndpoint": "https://589424541475.dkr.ecr.us-east-1.amazonaws.com"}]}


# Clear docker glitches.
$ unset ${!DOCKER*}

$ aws ecr help
-  batch-check-layer-availability
-  batch-delete-image
-  batch-get-image
-  complete-layer-upload
-  create-repository
-  delete-lifecycle-policy
-  delete-repository
-  delete-repository-policy
-  describe-images
-  describe-repositories
-  get-authorization-token
-  get-download-url-for-layer
-  get-lifecycle-policy
-  get-lifecycle-policy-preview
-  get-login
-  get-repository-policy
-  help
-  initiate-layer-upload
-  list-images
-  put-image
-  put-lifecycle-policy
-  set-repository-policy
-  start-lifecycle-policy-preview
-  upload-layer-part